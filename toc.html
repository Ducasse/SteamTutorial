<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">  	
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
  	<meta name="theme" content="hugo-academic">
    <meta name="theme-color" content="primary">
	<title></title>

    <!-- Highlight js -->
    <link rel="stylesheet" href="_support/html/highlightjs/styles/default.css">
    <link rel="stylesheet" href="_support/html/css/highlight-commands.css">
    <script src="_support/html/highlightjs/highlight.pack.js"></script>
    <script src="_support/html/js/highlight-commands.js"></script>

    <!-- Bootstrap -->
    <link href="_support/html/css/bootstrap.min.css" rel="stylesheet">
    <link href="_support/html/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="_support/html/css/square-braket-associates.css" rel="stylesheet">


  	<link href="_support/html/css/font-awesome.min.css" rel="stylesheet">
  	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" media="screen">
  	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.4/css/academicons.min.css">
    <link rel="stylesheet" href="_support/html/css/styles.css">
    <link rel="icon" type="image/png" href="_support/html/img/icon.png">
  	<link rel="apple-touch-icon" type="image/png" href="_support/html/img/icon-192.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto+Mono">

    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', '', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
	

    <style>
/*        .container { max-width: 55em; } */
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>


	<div class="article-header">
	<span class="article-header-caption">Steam Tutorial</span>
</div>

	<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        Steam Tutorial
      </a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse">

      <ul class="nav navbar-nav navbar-right">
		
        <li class="nav-item">
          <a href="/SteamTutorial/index.html#introduction">
            <span>Introduction</span>
          </a>
        </li>
		
        <li class="nav-item">
          <a href="/SteamTutorial/launching.html#launching">
            <span>Launching</span>
          </a>
        </li>
		
        <li class="nav-item">
          <a href="/SteamTutorial/sso.html#single sign on">
            <span>Single Sign On</span>
          </a>
        </li>
		
        <li class="nav-item">
          <a href="/SteamTutorial/stores.html#configure store">
            <span>Configure Store</span>
          </a>
        </li>
		
        <li class="nav-item">
          <a href="/SteamTutorial/coordinates.html#coordinates">
            <span>Coordinates</span>
          </a>
        </li>
		
      
      </ul>
      

    </div><!-- /.navbar-collapse -->
  </div><!-- /.container -->
</nav>


<!-- Projects widget -->
<section>
<div class="container">
<div class="row">
  <div class="col-xs-12 col-md-4 section-heading">
	<h1></h1>

    
  </div>
  <div class="col-xs-12 col-md-8">

	
<p>
<h1>Introduction</h1>

<p>
<a id="steamdiagram"></a>
<figure>
	<img src="/figures/final_preview.png" width="100%" id="steamdiagram" alt="Steam's preview"/>
	<figcaption>Steam's preview</figcaption>
</figure>
</p>
<p>
Steam is a framework that uses meta-description to create quickly web applications in Seaside and generate automatically other concerns like persistence. Steam uses Seaside, an open source framework of choice for developing sophisticated and dynamic web applications. Seaside uses the power of objects to master the web. Seaside is based on Smalltalk (like <a href="http://pharo.org/web">Pharo</a>).
</p>
<p>
<a id="steamdiagram"></a>
<figure>
	<img src="/figures/steam_conceptual_diagram.png" id="steamdiagram" alt="Steam's conceptual diagram"/>
	<figcaption>Steam's conceptual diagram</figcaption>
</figure>
</p>
<p class="note"><a href="http://pharo.org/web">Pharo</a> is a pure object-oriented programming language and a powerful environment, focused on simplicity and immediate feedback (think Integrated Development Environment (IDE) and Operating System (OS) rolled into one).</p>
<p>
In this tutorial we will see how we create a website and display/manage basic, then more complex objects thanks to Steam framework.
</p>
<p>
To make use the framework we will need to extend some classes as <code>STApplicationRootComponent</code> to create the main component that defines your application and <code>STObject</code> which will be the objects you want to manage.
</p>
<p>
For instance we will create two classes <code>GMCategory</code> and <code>GMGame</code> and add some methodes like this.
</p>
<p>
<a id="stobjects"></a>
<figure>
	<img src="/figures/stobject_subclasses_uml.png" width="35%" id="stobjects" alt="STObjects subclasses"/>
	<figcaption>STObjects subclasses</figcaption>
</figure>

</p>
<h1>Launching</h1>

<p>
First you need a Pharo 6.1 image, if you don't have it you can create a new one with <a href="https://pharo.org/download">Pharo Launcher</a>.
</p>
<h2>Installation</h2>

<p>
In the Pharo image open Iceberg and clone Steam's github repository.
</p>
<figure><pre><code>url : https://github.com/guillep/steam.git
repository : src</code></pre><figcaption></figcaption></figure>

<p>
<a id="iceberg"></a>
<figure>
	<img src="/figures/iceberg.png" id="iceberg" alt="Load Steam's Github repository with Iceberg"/>
	<figcaption>Load Steam's Github repository with Iceberg</figcaption>
</figure>
</p>
<p>
Now you have to install the baseline of steam.
It will download all the needed packages.
<a id="metacello"></a>
<figure>
	<img src="/figures/metacello.png" width="100%" id="metacello" alt="Steam installation with Metacello"/>
	<figcaption>Steam installation with Metacello</figcaption>
</figure>
</p>

<p class="note">If Iceberg gives you the choice between load existing or incoming version you can choose the first one if the version is greater (higher). It will take a few minutes (usually aroud 4 or 5 minutes).</p>

<p>
Ok, this is it ! All you will need is here, now you can continue with the initialization.
</p>
<h2>Steam application component</h2>

<p>
First we need to create a subclass of <code>STApplicationRootComponent</code>, you can name it <code>GameManager</code> for example.
</p><figure><pre><code>STApplicationRootComponent subclass: #GameManager
	instanceVariableNames: ''
	classVariableNames: ''
	package: 'Steam-Game-Manager'</code></pre><figcaption></figcaption></figure>

<p>
To make it work we need to override some superclass methods.
</p>
<p>
We begin with the initialization :
</p><figure><pre><code>GameManager &gt;&gt; initialize
	super initialize.
	
	&quot;Here you can choose your login object&quot;
	login := STBasicLogin on: self.
	
	&quot;Here you can define your application menu&quot;
	menuEntries := {}</code></pre><figcaption></figcaption></figure>
<p class="note">For now <code>menuEntries</code> is empty but we will create some classes to fill it up soon enough.</p>
<p>
We need a title for our application.
</p>
<figure><pre><code>GameManager &gt;&gt; title
	&quot;title will be diplayed on each web application page&quot;

	^ 'Game Manager'</code></pre><figcaption></figcaption></figure>

<p>
In the class side. The <code>applicationName</code> is the url extention for your website.
</p>
<figure><pre><code>GameManager class &gt;&gt; applicationName
	&quot;applicationName will be diplayed on the web application url&quot;

	^ 'Game Manager'</code></pre><figcaption></figcaption></figure>

<p>
We also need te override the <code>storeToUse</code> method to select the store we want to use.
</p>
<figure><pre><code>GameManager &gt;&gt; storeToUse
	^ STMemoryStore</code></pre><figcaption></figcaption></figure>

<p class="note">For now we're using a memory store to begin with. This store is just a playbox, so every object which is stored will be lost if you start a new session.</p>

<h2>Simple Object</h2>

<p>
Now let's create a simple new STObject subclass. For example let's call it <code>GMCategory</code>. With a inctance variable <code>title</code> which will be just a string representing the title.
</p>
<figure><pre><code>STObject subclass: #GMCategory
	instanceVariableNames: 'title'
	classVariableNames: ''
	package: 'Steam-Game-Manager'</code></pre><figcaption></figcaption></figure>


<p>
Add accessors.
</p>
<figure><pre><code>GMCategory &gt;&gt; title
	^ title</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMCategory &gt;&gt; title: aString
	title := aString</code></pre><figcaption></figcaption></figure>

<p>
Also a class side title.
</p>
<figure><pre><code>GMCategory class &gt;&gt; title
	^ 'Categories'</code></pre><figcaption></figcaption></figure>

<p>
And we need to add the description for Magritte.
</p>
<figure><pre><code>GameManager &gt;&gt; descriptionTitle
	&lt;magritteDescription&gt;
	^ MAStringDescription new
		label: 'Title';
		accessor: #title;
		beRequired;
		requiredErrorMessage: 'We cannot proceed without a title.';
		priority: 100;
		yourself</code></pre><figcaption></figcaption></figure>

<p>
Now we can add our new class to the <code>menuEntries</code> in <code>STManager</code>.
</p>
<figure><pre><code>GameManager &gt;&gt; initialize
	super initialize.
	
	&quot;Here you can choose your login object&quot;
	login := STExampleLogin on: self.
	
	&quot;Here you can define your application menu&quot;
	menuEntries := {
		STListAction on: GMCategory title: 'Categories'
	}</code></pre><figcaption></figcaption></figure>


<p>
After all is done, you can open a Playground then type and execute this code :
</p><figure><pre><code>GameManager startOn: 8181.</code></pre><figcaption></figcaption></figure>

<a id="note This will create a ==ZnZincServerAdaptor== server on port 8181 and initialize the web application."></a>
<p>
Now you can use your favorite browser and go at this address : <a href="http://localhost:8181/Game Manager">localhost:8181/Game Manager</a>.
</p>
<h2>More complex Object</h2>

<p>
We can now create a new STObject subclass which will contain a GMCategory object.
</p>
<figure><pre><code>STObject subclass: #GMGame
	instanceVariableNames: 'title category rating'
	classVariableNames: ''
	package: 'Steam-Game-Manager'</code></pre><figcaption></figcaption></figure>

<p>
Accessors..
</p>
<figure><pre><code>GMGame &gt;&gt; title
	^ title</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMGame &gt;&gt; title: aString
	title := aString</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMGame &gt;&gt; category
	^ category</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMGame &gt;&gt; category: aGMCategory
	category := aGMCategory</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMGame &gt;&gt; rating
	^ rating</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMGame &gt;&gt; rating: aNumber
	rating := aNumber</code></pre><figcaption></figcaption></figure>

<p>
A class side title.
</p>
<figure><pre><code>GMCategory class &gt;&gt; title
	^ 'Games'</code></pre><figcaption></figcaption></figure>

<p>
And the descriptions.
</p>
<figure><pre><code>GMGame &gt;&gt; descriptionTitle
	&lt;magritteDescription&gt;
	^ MAStringDescription new
		label: 'Title';
		accessor: #title;
		priority: 10;
		beSearchField;
		beRequired;
		requiredErrorMessage: 'We cannot proceed without a title.';
		componentClass: TBSMagritteTextInputComponent;
		yourself</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMGame &gt;&gt; descriptionCategory
	&lt;magritteDescription&gt;
	^ MASingleOptionDescription new
		label: 'Category';
		accessor: #category;
		priority: 20;
		options: ([steamApplication queryAll: GMCategory] on: Error do: [ nil ] );
		comment: 'Select a category';
		beSorted;
		componentClass: TBSMagritteSelectListComponent;
		requiredErrorMessage: 'You have to create a new category.';
		beRequired;
		beSearchField;
		propertyAt: #STObjectClass put: STGameCategory;
		yourself</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMGame &gt;&gt; descriptionRating
	&lt;magritteDescription&gt;
	^ MANumberDescription new
		priority: 30;
		label: 'Rating';
		accessor: #rating;
		comment: 'Game''s rating';
		min: 1;
		max: 10;
		beRequired;
		beSearchField;
		yourself</code></pre><figcaption></figcaption></figure>

<p>
Add our new class to the <code>menuEntries</code>.
</p>
<figure><pre><code>GameManager &gt;&gt; initialize
	super initialize.
	
	&quot;Here you can choose your login object&quot;
	login := STExampleLogin on: self.
	
	&quot;Here you can define your application menu&quot;
	menuEntries := {
		STListAction on: GMGame title: 'Games'.
		STListAction on: GMCategory title: 'Categories'
	}</code></pre><figcaption></figcaption></figure>

<p>
On your web page create a new session by clicking on &quot;New Session&quot; on the bottom left of the page in order to see the modifications.
</p>
<h2>Search Component</h2>

<p>
Now we will create a new component to search a string match in games, let's call it <code>GMSearchGameByTitle</code>.
</p>
<figure><pre><code>STObject subclass: #GMSearchGameByTitle
	instanceVariableNames: 'results searchValue'
	classVariableNames: ''
	package: 'Steam-Game-Manager'</code></pre><figcaption></figcaption></figure>

<p>
Override <code>initialize</code> and <code>title</code>.
</p>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; initialize
	super initialize.
	results := #()</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMSearchGameByTitle &gt;&gt; title
	&quot;this search component has no title&quot;

	^ ''</code></pre><figcaption></figcaption></figure>

<p>
Add accessors..
</p>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; results
	^ results</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; results: anObject
	results := anObject</code></pre><figcaption></figcaption></figure>

<figure><pre><code>GMSearchGameByTitle &gt;&gt; searchValue
	^ searchValue</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; searchValue: anObject
	searchValue := anObject</code></pre><figcaption></figcaption></figure>

<p>
Add the descriptions.
</p>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; descriptionResults
	&lt;magritteDescription&gt;
	^ MAToManyRelationDescription new
		label: 'Games';
		accessor: #results;
		beSearchResult;
		yourself</code></pre><figcaption></figcaption></figure>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; descriptionSearchField
	&lt;magritteDescription&gt;
	^ MAStringDescription new
		accessor: #searchValue;
		beSearchField;
		comment: 'Search for games';
		beRequired;
		yourself</code></pre><figcaption></figcaption></figure>

<p>
And to finish the action method <code>search</code>.
</p>
<figure><pre><code>GMSearchGameByTitle &gt;&gt; search
	results := (steamApplication query: GMGame with: searchValue)</code></pre><figcaption></figcaption></figure>

<p>
Add our new class to the <code>menuEntries</code>.
</p>
<figure><pre><code>GameManager &gt;&gt; initialize
	super initialize.
	
	&quot;Here you can choose your login object&quot;
	login := STExampleLogin on: self.
	
	&quot;Here you can define your application menu&quot;
	menuEntries := {
		STListAction on: GMGame title: 'Games'.
		STListAction on: GMCategory title: 'Categories'.
		STSearchAction on: (GMSearchGameByTitle onSteamApplication: self) title: 'Search Games'
	}</code></pre><figcaption></figcaption></figure>

<p>
Again start a new session to see our new component :).

</p>
<h1>Single Sign On</h1>

<p>
Here we will see how to create an OAuth client ID, so you can access user's data through Google or Github.
</p>
<h2>Google</h2>

<p>
First you need go to <a href="https://console.developers.google.com/apis">Google APIs</a> and log in with your google account.
Then in <strong>Credentials</strong> &gt; <strong>Create credentials</strong> &gt; <strong>OAuth client ID</strong>
<a id="google"></a>
<figure>
	<img src="/figures/creation_google_oauth.png" width="100%" id="google" alt="Google OAuth client ID"/>
	<figcaption>Google OAuth client ID</figcaption>
</figure>
</p>
<p>
Choose <strong>Web application</strong> and a name for your authentication application, you can use the same as for the steam app : &quot;Manager&quot;. 
</p>
<p class="note">The name will be displayed when a user will try to connect to your steam application via Google.</p>
<p>
For the <strong>Authorised redirect URIs</strong> put <code>http://localhost:8181/oauth2callback</code>.
</p>
<p>
<a id="google"></a>
<figure>
	<img src="/figures/finialization_google_oauth.png" width="100%" id="google" alt="Google OAuth finalization"/>
	<figcaption>Google OAuth finalization</figcaption>
</figure>
</p>
<p>
After clicking on <strong>Create</strong> you will need to copy and paste the <strong>client ID</strong> to key and <strong>client secret</strong> to secret in <code>GameManager</code> class side.
</p>
<figure><pre><code>GameManager class &gt;&gt; oauthHandlers
	^ {(STGoogleAuthHandler
		key: '' &quot;paste client ID here&quot;
		secret: '' &quot;paste client secret here&quot;
		redirectUrl: 'http://localhost:' , self seasideServer port asString , '/oauth2callback')}</code></pre><figcaption></figcaption></figure>

<p>
And we also have to initialize our class so it can be taken into account.
</p>
<figure><pre><code>GameManager initialize.</code></pre><figcaption></figcaption></figure>

<p>
You should be able to authentify yourself with google.
</p>

<h2>GitHub</h2>

<p>
It's basically the same for Github, you need go to <a href="https://github.com/settings/developers">Developer settings</a> and log in if it's not already done.
</p>
<p>
Then in <strong>OAuth Apps</strong> &gt; <strong>Register a new application</strong> or <strong>New OAuth App</strong> if you already have some.
</p>
<p>
For the <strong>Application name</strong> you can put &quot;Manager&quot;, for <strong>Homepage URL</strong> put &quot;http://localhost:8181/Manager&quot; and <strong>Authorization callback URL</strong> put &quot;http://localhost:8181/oauth2callback&quot;
</p>
<p>
<a id="github"></a>
<figure>
	<img src="/figures/finialization_github_oauth.png" width="100%" id="github" alt="Github OAuth finalization"/>
	<figcaption>Github OAuth finalization</figcaption>
</figure>
</p>
<p>
After clicking on <strong>Register application</strong> you will need to copy and paste the <strong>client ID</strong> to key and <strong>client secret</strong> to secret in <code>GameManager</code> class side.
</p>
<figure><pre><code>GameManager class &gt;&gt; oauthHandlers
	^ {(STGoogleAuthHandler
		key: '' &quot;google client ID&quot;
		secret: '' &quot;google client secret&quot;
		redirectUrl: 'http://localhost:' , self seasideServer port asString , '/oauth2callback').
	(STGithubAuthHandler
		key: '' &quot;paste client ID here&quot;
		secret: '' &quot;paste client secret here&quot;
		redirectUrl: 'http://localhost:' , self seasideServer port asString , '/oauth2callback')}</code></pre><figcaption></figcaption></figure>

<p>
Again don't forget to initialize our class so it can be taken into account.
</p>
<figure><pre><code>GameManager initialize.</code></pre><figcaption></figcaption></figure>

<p>
Google and GitHub should work now.

</p>
<h1>Configure Store</h1>

<p>
In this section we will learn how to use <strong>MongoDB</strong> (a document-oriented database) and <strong>PostgreSQL</strong> (a object-relational database system).
</p>
<h2>Mongo</h2>

<p>
To begin with you have to install it on your computer first. You can find a documentation <a href="https://docs.mongodb.com/manual/administration/install-community/">here</a>.
</p>
<p>
Then to run it, open a terminal and execute <code>mongod</code> you may need to put sudo before <code>sudo mongod</code>.
</p>

<h2>PostgreSQL</h2>

<p>
For PgSql you can find a documentation <a href="https://www.postgresql.org/download/">here</a>.
</p>
<ol><li>Choose the store</li>
</ol>

<p>
This is very easy, you just have to change the method <code>STManager &gt;&gt; storeToUse</code> to return the store you want to use : <code>STMongoStore</code> or <code>STPostgresSQLStore</code>.
</p>
<h2>Configure STPostgresSQLStore</h2>

<p>
To configure the STPostgresSQLStore you have to change the <code>STPostgresSQLStore class &gt;&gt; login</code> method.
</p><figure><pre><code>login
	^ Login new
		database: PostgreSQLPlatform new;
		&quot;here use the username you picked when installed PgSQL&quot;
		username: 'pierretsapliayeu';
		&quot;the password is optionnal but you can use one&quot;
		password: 'secret';
		&quot;connect string looks like hostname:portNumber_db-name.
		:portNumber is optional&quot;
		connectString: 'localhost:5432_pierretsapliayeu';
		encodingStrategy: #utf8.</code></pre><figcaption></figcaption></figure>

<p>
After the installation and configuration of the store you have to create tables by executing <code>STManager new createTables</code>
</p>
<p class="note">If you want to drop tables you can run <code>STManager new dropTables</code>.</p>

<h1>Coordinates</h1>

<p>
Contact me. I'm open for collaborations.
All that you need about lost people.
I will help you find them
</p>
<h2>Email</h2>

<p>
johndoe@mail.com
</p>
<h2>Snail mail / Visits</h2>

<p>

Space Laboratory - J. Doe, 1500, avenue des Disparus,<br/>
Parc d'Attraction,<br/>
France<br/>
Tel:33 (0)0 00 00 00 00<br/>
Fax:33 (0)8 88 88 88 88<br/>

</p>

</p>

  </div>
</div>
</div>
</section>
	

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="_support/html/js/bootstrap.min.js"></script>

    <!-- Syntax highlighting of code blocks -->
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Prettify annotated paragraphs-->
    <script src="_support/html/js/annotated-paragraphs.js"></script>

	<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://github.com/pillar-markup/pillar" target="_blank" rel="noopener">Pillar</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>



  </body>
</html>
